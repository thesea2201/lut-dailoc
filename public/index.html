<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>B√°o c√°o th·ªßy ƒëi·ªán</title>
    <style>
      :root {
        color-scheme: light dark;
        font-size: 16px;
      }
      body {
        font-family: "Inter", "Segoe UI", system-ui, sans-serif;
        margin: 0;
        padding: clamp(1rem, 4vw, 2.5rem);
        background-color: #f7f9fc;
        color: #0f172a;
        line-height: 1.6;
      }
      main {
        max-width: 960px;
        margin: 0 auto;
      }
      h1,
      h2 {
        margin: 0 0 1rem;
        line-height: 1.3;
      }
      p {
        margin: 0 0 1rem;
      }
      .summary {
        background: #fff;
        padding: clamp(1rem, 2vw, 1.5rem);
        border-radius: 0.75rem;
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
        margin-bottom: clamp(1rem, 3vw, 2rem);
      }
      section {
        margin-bottom: clamp(1rem, 3vw, 2rem);
        background: #fff;
        padding: clamp(1rem, 2vw, 1.5rem);
        border-radius: 0.75rem;
        box-shadow: 0 8px 18px rgba(15, 23, 42, 0.08);
      }
      img {
        width: 100%;
        height: auto;
        display: block;
        margin-top: 1rem;
        border: 1px solid #d5deff;
        border-radius: 0.5rem;
        background: #f8fafc;
      }
      a {
        color: #0d6efd;
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
      time {
        font-weight: 600;
      }
      @media (max-width: 640px) {
        body {
          padding: 1rem;
        }
        h1 {
          font-size: 1.4rem;
        }
        h2 {
          font-size: 1.1rem;
        }
        section,
        .summary {
          box-shadow: 0 6px 14px rgba(15, 23, 42, 0.06);
        }
        section {
          padding: 1rem;
        }
        section img {
          width: 100%;
          margin: 1rem 0 0;
        }
        .full-bleed img {
          width: calc(100% + 2rem);
          margin: 1rem -1rem 0;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <header class="summary">
        <h1>B√°o c√°o th·ªßy ƒëi·ªán | L∆∞u v·ª±c s√¥ng Vu Gia - Thu B·ªìn</h1>
        <p>
          Ba bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y ƒë∆∞·ª£c c·∫≠p nh·∫≠t t·ª± ƒë·ªông m·ªói 30 ph√∫t.<br />
          L·∫ßn c·∫≠p nh·∫≠t m·ªõi nh·∫•t: <time id="last-updated">ƒëang t·∫£i...</time>
        </p>
        <p>
          üí¨
          <a href="https://t.me/lut_dailoc" target="_blank" rel="noopener noreferrer"
            >Tham gia nh√≥m Telegram</a
          >
          ƒë·ªÉ nh·∫≠n th√¥ng b√°o khi l∆∞u l∆∞·ª£ng v∆∞·ª£t ng∆∞·ª°ng c·∫£nh b√°o.
        </p>
      </header>

      <section class="full-bleed">
        <h2>Di·ªÖn bi·∫øn l∆∞u l∆∞·ª£ng theo gi·ªù</h2>
        <picture>
          <source media="(max-width: 768px)" srcset="baocaothuydien_plot_mobile.png" />
          <img src="baocaothuydien_plot.png" alt="Bi·ªÉu ƒë·ªì l∆∞u l∆∞·ª£ng theo gi·ªù" loading="lazy" />
        </picture>
      </section>

      <section class="full-bleed">
        <h2>So s√°nh l∆∞u l∆∞·ª£ng c√πng gi·ªù gi·ªØa c√°c ng√†y</h2>
        <picture>
          <source media="(max-width: 768px)" srcset="baocaothuydien_plot_overlay_mobile.png" />
          <img
            src="baocaothuydien_plot_overlay.png"
            alt="Bi·ªÉu ƒë·ªì so s√°nh l∆∞u l∆∞·ª£ng c√πng gi·ªù gi·ªØa c√°c ng√†y"
            loading="lazy"
          />
        </picture>
      </section>

      <section class="full-bleed" id="stations">
        <h2>M·ª±c n∆∞·ªõc c√°c tr·∫°m</h2>
        <div id="station-list">
          <p>ƒêang t·∫£i d·ªØ li·ªáu tr·∫°m...</p>
        </div>
      </section>
    </main>

    <script>
      const lastUpdatedEl = document.getElementById('last-updated');
      const stationListEl = document.getElementById('station-list');
      const flowSource = 'baocaothuydien_plot.png';

      async function updateTimestamp() {
        try {
          const response = await fetch(flowSource, { method: 'HEAD', cache: 'no-store' });
          const lastModified = response.headers.get('Last-Modified');
          if (!lastModified) throw new Error('missing header');
          lastUpdatedEl.textContent = new Date(lastModified).toLocaleString();
        } catch (error) {
          lastUpdatedEl.textContent = 'Kh√¥ng x√°c ƒë·ªãnh';
        }
      }

      function renderStationSection(station) {
        const section = document.createElement('article');
        section.className = 'station-card';
        section.innerHTML = `
          <h3>${station.label}</h3>
          <picture>
            <source media="(max-width: 768px)" srcset="${station.imageMobile}" />
            <img src="${station.image}" alt="Bi·ªÉu ƒë·ªì m·ª±c n∆∞·ªõc ${station.label}" loading="lazy" />
          </picture>
        `;
        return section;
      }

      async function loadStations() {
        try {
          const response = await fetch('stations.json', { cache: 'no-store' });
          if (!response.ok) throw new Error('failed to load stations');
          const stations = await response.json();
          if (!Array.isArray(stations) || stations.length === 0) {
            stationListEl.innerHTML = '<p>Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu tr·∫°m.</p>';
            return;
          }
          stationListEl.innerHTML = '';
          stations.forEach((station) => {
            stationListEl.appendChild(renderStationSection(station));
          });
        } catch (error) {
          stationListEl.innerHTML = '<p>Kh√¥ng th·ªÉ t·∫£i danh s√°ch tr·∫°m.</p>';
        }
      }

      updateTimestamp();
      loadStations();
    </script>
  </body>
</html>
